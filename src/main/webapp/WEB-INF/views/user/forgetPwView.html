<!DOCTYPE html>
<html lang="en">

<head>
<title>ZUPA - Responsive Website Template / Portfolio</title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
<link rel="shortcut icon"
	href="../../../resources/HTML/images/favicon.ico" />
<link
	href='https://fonts.googleapis.com/css?family=Lato:400,300,700&amp;subset=latin,latin-ext'
	rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css"
	href="../../../resources/HTML/bootstrap/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css"
	href="../../../resources/HTML/css/animate.css" />
<link rel="stylesheet" type="text/css"
	href="../../../resources/HTML/css/font-awesome.min.css" />
<link rel="stylesheet" type="text/css"
	href="../../../resources/HTML/css/swiper.min.css" />
<link rel="stylesheet" type="text/css"
	href="../../../resources/HTML/css/style.css" />
<script src="../../../resources/HTML/javascript/pace.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="../../../resources/HTML/bootstrap/js/bootstrap.min.js"></script>
<script src="../../../resources/HTML/javascript/modernizr-custom.js"></script>
<script src="../../../resources/HTML/javascript/script.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<script src="../../../resources/js/user/user.js"></script>
<script src="../../../resources/js/user/userController.js"></script>

<script src="../../../resources/HTML/javascript/isotope.min.js"></script>
</head>

<script>
	$(document).ready(function() {

		var userController = new UserController();

		var emailSendSuccess = false;
		var certificationNum; // 인증번호
		var email; // 비밀번호 찾기 대상 아이디

		// 이메일 인증번호 발송	
		$('#email_send').click(function() {

			var status = checkEmail(); // 이메일 유효성 검사 
			if (status) {
				// 				$("#email_alert").show();
				certificationNum = parseInt(Math.random() * 1000000); // ?????
				email = $('#id').val();
				alert(certificationNum);
				emailSendSuccess = userController.requestForgetPwEmailSend(email, certificationNum);
				// 				$("#email_alert").hide();
			}
		});

		// 이메일 인증번호 확인 
		$("#email_check").click(function() {

			if (emailSendSuccess) { // 인증번호를 전송한 상태
				var userInputNum = $('#email_confirm').val();
				var email = $('#id').val();
				if (userInputNum == certificationNum) { // 인증번호 일치시 다음 비밀번호 찾기 페이지로 이동
					userController.requestForgetPwUpdateUrl(email);
				} else {
					alert("인증번호를 올바르게 입력해주세요.");
					$('#email_confirm').focus();
				}
			} else {
				alert("인증번호 전송을 먼저 수행하십시오.");
			}
		});

		// 이메일 인증 유효성 검사
		function checkEmail() {

			var idChk = /([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/; // 이메일
			var id = $("#id").val();

			if (!$("#id").val()) {
				alert("이메일을 입력해주세요.");
				$("#id").focus();
				return false;
			}

			if (!idChk.test(id)) {
				alert("이메일 주소가 유효하지 않습니다.");
				$("#id").focus();
				return false;
			}

			if ($("#id").val().length < 6) {
				alert("이메일은 6자리 이상 입력해주세요");
				$("#id").focus();
				return false;
			}

			return true;
		}

	});
</script>

<style>
@font-face {
	font-family: 'baemin';
	src: url(../../../resources/bootstrap/fonts/배달의민족주아체.ttf);
}

body {
	font-family: 'baemin';
}

#email_send, #email_check {
	height: 37px;
}
</style>

<body>

	<div class="container">
		<div class="row">
			<div class="col-lg-8 col-lg-offset-2 col-md-12">
				<article class="content">
					<section>

						<!-- 비밀번호 찾기-->
						<h2>비밀번호 찾기</h2>

						<div class="form-horizontal">

							<!-- 아이디 -->
							<div class="form-group">
								<label class="col-sm-3 control-label">아이디(E-mail)</label>
								<div class="col-sm-6 animated-form-control">
									<input placeholder="E-mail" type="text" name="name"
										class="text form-control" id="id" required="required"
										aria-required="true" />
								</div>
								<div class="col-sm-1 ">
									<button id="email_send" class="btn btn-primary">인증요청</button>
								</div>
							</div>

							<!-- 인증번호 확인 -->
							<div class="form-group">
								<label class="col-sm-3 control-label">인증번호</label>
								<div class="col-sm-6 animated-form-control">
									<input placeholder="Confirm Number" type="text" name="name"
										class="text form-control" id="email_confirm"
										required="required" aria-required="true" />
								</div>
								<div class="col-sm-1">
									<button id="email_check" class="btn btn-primary">인증확인</button>
								</div>
							</div>

						</div>

					</section>
				</article>
			</div>
		</div>
	</div>


</body>

</html>
